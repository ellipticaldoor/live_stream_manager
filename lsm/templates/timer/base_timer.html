{% extends 'base.html' %}

{% block content %}
<div id="timer_container">
	<div id="video"></div>

	<div id="timer" class="clock">
		<span id="clock"></span>
	</div>
</div>
{% endblock %}

{% block js %}
<script>
$(document).ready(function() {
	var time = 1000 * 60 * 1;
	var current_video = 0;

	var youtube_videos = [
		{"linkID": "Qi7KDOAj4Xo", "date": "2020/10/10 12:34:56", "status": "recorded"},
		{"linkID": "lTXGz68Qz0g", "date": "2020/10/10 12:34:56", "status": "recorded"},
		{"linkID": "dghosA-zI6k", "date": "2020/10/10 12:34:56", "status": "recorded"},
	]

	setTimer(time, youtube_videos[current_video].linkID)
});

function setTimer(time, linkID) {
	now = new Date();

	var clock = $('#clock');

	clock.countdown(now.getTime() + time);

	clock.on('update.countdown', function(event) {
		var totalHours = event.offset.totalDays * 24 + event.offset.hours;
		$(this).html(event.strftime(totalHours + ' hr  %M min  %S seg'));
	});

	clock.on('finish.countdown', function(event) {
		$('#timer').hide();
		$('#video').show();

		autoPlayVideo(linkID,'100%','100%');
	});
}

function autoPlayVideo(vcode, width, height){
	"use strict";
	$("#video").html('<iframe width="'+width+'" height="'+height+'" src="https://www.youtube.com/embed/'+vcode+'?autoplay=1&loop=1&rel=0&wmode=transparent" frameborder="0" allowfullscreen wmode="Opaque"></iframe>');
}
</script>
{% endblock %}
